{"version":3,"sources":["webpack:///./js/preloader/preloader.js","webpack:///./js/services/apiService.js","webpack:///./js/photos/photosWithSearch.js","webpack:///./templates/photoCard.hbs","webpack:///./templates/photosList.hbs"],"names":["preloaderFactory","selector","element","document","querySelector","hide","this","classList","add","show","remove","KEY","page","query","fetch","BASE_URL","rawResult","ok","json","result","preloader","searchForm","photos","currentPhotos","searchQuery","observeEnable","filterByQuery","filter","photo","tags","toLowerCase","includes","renderPhotos","addObserver","observerHandler","debounce","entries","isIntersecting","fetchPhotos","observer","IntersectionObserver","rootMargin","observerElement","createElement","insertAdjacentElement","observe","photosWithPosterPath","map","photosList","photosListTemplate","innerHTML","searchPhotos","console","log","photosService","hits","init","addEventListener","target","name","value","Handlebars","module","exports","template","container","depth0","helpers","partials","data","helper","alias1","escapeExpression","alias2","nullContext","alias3","hooks","helperMissing","alias4","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","lambda","stack1","invokePartial","decorators","program","noop"],"mappings":"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","file":"main.91c57a46551e8a167d6d.js","sourcesContent":["const preloaderFactory = selector => {\n  return {\n    element: document.querySelector(selector),\n    hide() {\n      this.element.classList.add('disable');\n    },\n    show() {\n      this.element.classList.remove('disable');\n    },\n  };\n};\n\nexport default preloaderFactory;\n","const BASE_URL = 'https://pixabay.com/api/'; // API_URL\n// const query = ''; // что_искать\n// const page = '1'; // номер_страницы\nconst KEY = '21420478-fd2340d70fd107c9f0617a1e9'; //твой_ключ\n\nexport default {\n  async fetchPhotos(page, query) {\n    const rawResult = await fetch(\n      `${BASE_URL}?image_type=photo&orientation=horizontal&q=${query}&page=${page}&per_page=12&key=${KEY}`,\n    );\n    if (!rawResult.ok) {\n      throw rawResult;\n    }\n    const result = await rawResult.json();\n    return result;\n  },\n  async searchPhotos(query, page) {\n    const rawResult = await fetch(\n      `${BASE_URL}?image_type=photo&orientation=horizontal&q=${query}&page=${page}&per_page=12&key=${KEY}`,\n    );\n    if (!rawResult.ok) {\n      throw rawResult;\n    }\n    const result = await rawResult.json();\n    return result;\n  },\n};\n","import preloaderFactory from '../preloader/preloader';\nimport photosService from '../services/apiService';\nimport photosListTemplate from '../../templates/photosList.hbs';\nimport debounce from 'lodash.debounce';\nimport '../../css/photos.css';\n\nconst preloader = preloaderFactory('.preloader');\n\nconst searchForm = document.querySelector('.search-form');\n\nclass Photos {\n  constructor(selector) {\n    this.element = document.querySelector(selector);\n    this.photos = [];\n    this.currentPhotos = [];\n    this.searchQuery = '';\n    this.page = 0;\n\n    this.observeEnable = true;\n  }\n\n  filterByQuery(query = '') {\n    this.observeEnable = false;\n    this.currentPhotos = query\n      ? this.photos.filter(photo =>\n          photo.tags.toLowerCase().includes(query.toLowerCase()),\n        )\n      : this.photos;\n\n    this.renderPhotos();\n  }\n\n  addObserver() {\n    const observerOption = {\n      rootMargin: '100px',\n    };\n    const observerHandler = debounce(entries => {\n      if (!this.observeEnable) return;\n      if (entries[0].isIntersecting) {\n        this.page += 1;\n        this.fetchPhotos(this.page);\n      }\n    }, 200);\n\n    const observer = new IntersectionObserver(observerHandler, observerOption);\n    const observerElement = document.createElement('div');\n\n    this.element.insertAdjacentElement('afterend', observerElement);\n    observer.observe(observerElement);\n  }\n\n  renderPhotos() {\n    const photosWithPosterPath = this.currentPhotos.map(photo => {\n      return {\n        ...photo,\n      };\n    });\n    const photosList = photosListTemplate(photosWithPosterPath);\n    this.element.innerHTML = photosList;\n  }\n\n  searchPhotos() {\n    this.page = 1;\n    this.searchQuery = query;\n    this.fetchPhotos(this.page, this.searchQuery);\n  }\n\n  async fetchPhotos(page, query = '') {\n    this.searchQuery = query;\n    console.log(query);\n\n    try {\n      const { hits } = query\n        ? await photosService.searchPhotos(query, page)\n        : await photosService.fetchPhotos(page);\n      console.log(hits);\n\n      this.photos = [...this.photos, ...hits];\n      this.currentPhotos = this.photos;\n      this.renderPhotos();\n      // console.log(hits);\n    } catch (error) {\n      // TODO add users notify for errors\n      console.log(error);\n    } finally {\n      preloader.hide();\n    }\n  }\n\n  init() {\n    this.addObserver();\n  }\n}\n\nconst photos = new Photos('.photos-list');\nphotos.init();\n\nconst searchHandler = ({ target }) => {\n  if (target.name === 'search-query') {\n    photos.searchPhotos(target.value);\n    console.log(target.value);\n  }\n};\n\nsearchForm.addEventListener('input', searchHandler);\n","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=container.escapeExpression, alias2=depth0 != null ? depth0 : (container.nullContext || {}), alias3=container.hooks.helperMissing, alias4=\"function\", lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"photo-card\\\">\\n    <img src=\\\"\"\n    + alias1(container.lambda((depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0), depth0))\n    + \"\\\" alt=\\\"photo-card__webformatURL\\\" class=\\\"photo-card__webformatURL\\\">\\n\\n    <div class=\\\"photo-card__stats\\\">\\n\\n        <p class=\\\"likes\\\">\"\n    + alias1(((helper = (helper = lookupProperty(helpers,\"likes\") || (depth0 != null ? lookupProperty(depth0,\"likes\") : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":9,\"column\":25},\"end\":{\"line\":9,\"column\":34}}}) : helper)))\n    + \" <br \\\\ />likes</p> \\n\\n        <p class=\\\"views\\\">\"\n    + alias1(((helper = (helper = lookupProperty(helpers,\"views\") || (depth0 != null ? lookupProperty(depth0,\"views\") : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":11,\"column\":25},\"end\":{\"line\":11,\"column\":34}}}) : helper)))\n    + \" <br \\\\ />views</p> \\n\\n        <p class=\\\"comments\\\">\"\n    + alias1(((helper = (helper = lookupProperty(helpers,\"comments\") || (depth0 != null ? lookupProperty(depth0,\"comments\") : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"comments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":13,\"column\":28},\"end\":{\"line\":13,\"column\":40}}}) : helper)))\n    + \" <br \\\\ />comments</p> \\n\\n        <p class=\\\"downloads\\\">\"\n    + alias1(((helper = (helper = lookupProperty(helpers,\"downloads\") || (depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":15,\"column\":29},\"end\":{\"line\":15,\"column\":42}}}) : helper)))\n    + \" <br \\\\ />downloads</p> \\n    </div>\\n    <span class=\\\"tags\\\">\"\n    + alias1(((helper = (helper = lookupProperty(helpers,\"tags\") || (depth0 != null ? lookupProperty(depth0,\"tags\") : depth0)) != null ? helper : alias3),(typeof helper === alias4 ? helper.call(alias2,{\"name\":\"tags\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":17,\"column\":23},\"end\":{\"line\":17,\"column\":31}}}) : helper)))\n    + \"</span>\\n</div>\";\n},\"useData\":true});","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var stack1;\n\n  return ((stack1 = container.invokePartial(require(\"./photoCard.hbs\"),depth0,{\"name\":\"./photoCard.hbs\",\"data\":data,\"helpers\":helpers,\"partials\":partials,\"decorators\":container.decorators})) != null ? stack1 : \"\");\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":3,\"column\":9}}})) != null ? stack1 : \"\");\n},\"usePartial\":true,\"useData\":true});"],"sourceRoot":""}